(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0740bc82"],{"2e54":function(e,t,s){},"788d":function(e,t,s){"use strict";s.r(t);var i=s("2909"),l=(s("99af"),s("a15b"),s("d3b7"),s("159b"),{name:"Roles",data:function(){return{rolesList:[],setRightDialogVisible:!1,roleTreeList:[],defaultProps:{children:"children",label:"authName"},defKeys:[],roleId:""}},methods:{allRolesList:function(){var e=this;this.$api.rights.getAllRoles().then((function(t){if(200!==t.meta.status)return e.$messsage.error(t.meta.msg);e.rolesList=t.data}))},removeByRights:function(e,t){var s=this;this.$confirm("确定删除此角色权限, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){s.$api.rights.getDelRoles(e,t).then((function(t){if(200!==t.meta.status)return s.$message.error(s.meta.msg);e.children=t.data})),s.$message({type:"success",message:"删除成功!"})})).catch((function(e){}))},showSetRightDialog:function(e){var t=this;this.roleId=e.id,this.$api.rights.getAllRights("tree").then((function(s){t.$fn.error(s),t.roleTreeList=s.data,t.getThreeId(e,t.defKeys),t.setRightDialogVisible=!0}))},allotRights:function(){var e=this,t=[].concat(Object(i.a)(this.$refs.treeRef.getCheckedKeys()),Object(i.a)(this.$refs.treeRef.getHalfCheckedKeys()));this.$api.rights.getRoleRights(this.roleId,t.join(",")).then((function(t){e.$fn.error(t),e.allRolesList(),e.setRightDialogVisible=!1}))},getThreeId:function(e,t){var s=this;if(!e.children)return t.push(e.id);e.children.forEach((function(e){s.getThreeId(e,t)}))},clearRoles:function(){this.defKeys=[]}},mounted:function(){this.allRolesList()}}),a=(s("f6fe"),s("2877")),r=Object(a.a)(l,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),s("el-breadcrumb-item",[e._v("权限管理")]),s("el-breadcrumb-item",[e._v("角色列表")])],1),s("el-card",[s("el-row",{staticClass:"add-roles-btn"},[s("el-col",[s("el-button",{attrs:{type:"primary"}},[e._v("添加角色")])],1)],1),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:!e.rolesList.length,expression:"!rolesList.length"}],staticStyle:{width:"100%"},attrs:{data:e.rolesList,border:"",stripe:"","element-loading-text":"数据加载中..."}},[s("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return e._l(i.children,(function(t,l){return s("el-row",{key:t.id,class:["bdbottom",0===l?"bdtop":"","vcenter"]},[s("el-col",{attrs:{span:5}},[s("el-tag",{staticClass:"one-tag",attrs:{closable:""},on:{close:function(s){return e.removeByRights(i,t.id)}}},[e._v(e._s(t.authName))]),s("i",{staticClass:"el-icon-caret-right"})],1),s("el-col",{attrs:{span:19}},e._l(t.children,(function(t,l){return s("el-row",{key:t.id,class:[0===l?"":"bdtop","vcenter"]},[s("el-col",{attrs:{span:6}},[s("el-tag",{staticClass:"one-tag",attrs:{type:"success",closable:""},on:{close:function(s){return e.removeByRights(i,t.id)}}},[e._v(e._s(t.authName))]),s("i",{staticClass:"el-icon-caret-right"})],1),s("el-col",{attrs:{span:18}},e._l(t.children,(function(t,l){return s("el-tag",{key:t.id,staticClass:"one-tag",attrs:{type:"warning",closable:""},on:{close:function(s){return e.removeByRights(i,t.id)}}},[e._v(e._s(t.authName))])})),1)],1)})),1)],1)}))}}])}),s("el-table-column",{attrs:{label:"#",type:"index"}}),s("el-table-column",{attrs:{label:"角色名称",prop:"roleName"}}),s("el-table-column",{attrs:{label:"角色描述",prop:"roleDesc"}}),s("el-table-column",{attrs:{label:"操作",width:"300px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[s("el-button",{attrs:{icon:"el-icon-edit",size:"mini",type:"primary"}},[e._v("编辑 ")]),s("el-button",{attrs:{icon:"el-icon-delete",size:"mini",type:"danger"}},[e._v("删除 ")]),s("el-button",{attrs:{icon:"el-icon-setting",size:"mini",type:"warning"},on:{click:function(t){return e.showSetRightDialog(i)}}},[e._v("分配权限 ")])]}}])})],1)],1),s("el-dialog",{attrs:{visible:e.setRightDialogVisible,title:"分配权限",width:"50%"},on:{"update:visible":function(t){e.setRightDialogVisible=t},close:e.clearRoles}},[s("el-tree",{ref:"treeRef",attrs:{data:e.roleTreeList,props:e.defaultProps,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":e.defKeys}}),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.setRightDialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.allotRights()}}},[e._v("确 定")])],1)],1)],1)}),[],!1,null,"7b67b625",null);t.default=r.exports},f6fe:function(e,t,s){"use strict";s("2e54")}}]);